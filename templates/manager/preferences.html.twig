{% extends 'base.html.twig' %}

{% block title %}Alternatives{% endblock %}

{% block stylesheets1 %}
<style>
    /*
*
* ==========================================
* CUSTOM UTIL CLASSES
* ==========================================
*/
    .nav-pills-custom .nav-link {
        color: #aaa;
        background: #fff;
        position: relative;
    }

    .nav-pills-custom .nav-link.active {
        color: #45b649;
        background: #fff;
    }


    /* Add indicator arrow for the active tab */
    @media (min-width: 992px) {
        .nav-pills-custom .nav-link::before {
            content: '';
            display: block;
            border-top: 8px solid transparent;
            border-left: 10px solid #fff;
            border-bottom: 8px solid transparent;
            position: absolute;
            top: 50%;
            right: -10px;
            transform: translateY(-50%);
            opacity: 0;
        }
    }

    .nav-pills-custom .nav-link.active::before {
        opacity: 1;
    }


    /*
        *
        * ==========================================
        * FOR DEMO PURPOSE
        * ==========================================
        */
    body {
        min-height: 100vh;
        background: linear-gradient(to left, #dce35b, #45b649);
    }
</style>

{% endblock %}

{% block body1 %}



<div class="container">
    <ol class="track-progress">

        {% if app.session.get('project').id is defined %}
        {% if app.user.evaluateEntreprise.id is defined %}
        {% if app.user.evaluateEntreprise.id == app.session.get('project').id %}
        <li style="width: 11.1% !important;" class="done">
            <em>1</em>
            <span data-toggle="tooltip" title="Create Project">1</span>
        </li>
        <li style="width: 11.1% !important;" class="done">
            <em>2</em>
            <span data-toggle="tooltip" title="Generate Evaluateures">2</span>
        </li>
        <li style="width: 11.1% !important;" class="done">
            <em>3</em>
            <span data-toggle="tooltip" title="Add criteria">3</span>
        </li>
        <li style="width: 11.1% !important;" class="done">
            <em>4</em>
            <span data-toggle="tooltip" title="Criteria validation">4</span>
        </li>

        <li style="width: 11.1% !important;" class="done">
            <em>5</em>
            <span data-toggle="tooltip" title="Add Preference">5</span>
        </li>

        <li style="width: 11.1% !important;" class="done">
            <em>6</em>
            <span data-toggle="tooltip" title="Add Alternatives">6</span>
        </li>

        <li style="width: 11.1% !important;" class="done">
            <em>7</em>
            <span data-toggle="tooltip" title="Generate Experts">7</span>
        </li>

        <li style="width: 11.1% !important;" class="done">
            <em>8</em>
            <span id="activated" data-toggle="tooltip" title="Preferences">8</span>
        </li>

        <li style="width: 11.1% !important;" class="todo">
            <em>9</em>
            <span data-toggle="tooltip" title="Binary preferences">9</span>
        </li>
        {% else %}
        <li style="width: 14.2% !important;" class="done">
            <em>1</em>
            <span data-toggle="tooltip" title="Create Project">1</span>
        </li>
        <li style="width: 14.2% !important;" class="done">
            <em>2</em>
            <span data-toggle="tooltip" title="Generate Evaluateures">2</span>
        </li>
        <li style="width: 14.2% !important;" class="done">
            <em>3</em>
            <span data-toggle="tooltip" title="Criteria validation">3</span>
        </li>-
        <li style="width: 14.2% !important;" class="done">
            <em>4</em>
            <span data-toggle="tooltip" title="Add Alternatives">4</span>
        </li>
        <li style="width: 14.2% !important;" class="done">
            <em>5</em>
            <span data-toggle="tooltip" title="Generate Experts">5</span>
        </li>
        <li style="width: 14.2% !important;" class="done">
            <em>6</em>
            <span id="activated" data-toggle="tooltip" title="Preferences">6</span>
        </li>
        <li style="width: 14.2% !important;" class="todo">
            <em>7</em>
            <span data-toggle="tooltip" title="Binary preferences">7</span>
        </li>
        {% endif %}
        {% else %}
        <li style="width: 14.2% !important;" class="done">
            <em>1</em>
            <span data-toggle="tooltip" title="Create Project">1</span>
        </li>
        <li style="width: 14.2% !important;" class="done">
            <em>2</em>
            <span data-toggle="tooltip" title="Generate Evaluateures">2</span>
        </li>
        <li style="width: 14.2% !important;" class="done">
            <em>3</em>
            <span data-toggle="tooltip" title="Criteria validation">3</span>
        </li>-
        <li style="width: 14.2% !important;" class="done">
            <em>4</em>
            <span data-toggle="tooltip" title="Add Alternatives">4</span>
        </li>
        <li style="width: 14.2% !important;" class="done">
            <em>5</em>
            <span data-toggle="tooltip" title="Generate Experts">5</span>
        </li>
        <li style="width: 14.2% !important;" class="done">
            <em>6</em>
            <span id="activated" data-toggle="tooltip" title="Preferences">6</span>
        </li>
        <li style="width: 14.2% !important;" class="todo">
            <em>7</em>
            <span data-toggle="tooltip" title="Binary preferences">7</span>
        </li>
        {% endif %}

        {% else %}
        <li style="width: 14.2% !important;" class="done">
            <em>1</em>
            <span data-toggle="tooltip" title="Create Project">1</span>
        </li>
        <li style="width: 14.2% !important;" class="done">
            <em>2</em>
            <span data-toggle="tooltip" title="Generate Evaluateures">2</span>
        </li>
        <li style="width: 14.2% !important;" class="done">
            <em>3</em>
            <span data-toggle="tooltip" title="Criteria validation">3</span>
        </li>-
        <li style="width: 14.2% !important;" class="done">
            <em>4</em>
            <span data-toggle="tooltip" title="Add Alternatives">4</span>
        </li>
        <li style="width: 14.2% !important;" class="done">
            <em>5</em>
            <span data-toggle="tooltip" title="Generate Experts">5</span>
        </li>
        <li style="width: 14.2% !important;" class="done">
            <em>6</em>
            <span id="activated" data-toggle="tooltip" title="Preferences">6</span>
        </li>
        <li style="width: 14.2% !important;" class="todo">
            <em>7</em>
            <span data-toggle="tooltip" title="Binary preferences">7</span>
        </li>
        {% endif %}
    </ol>
    <br>
    <br>
    <br>
    <!-- Demo header-->
    <!-- Demo header-->
    <section class="py-5 header">
        <div class="container py-4">
            <div class="row">
                <div class="col-md-3">
                    <!-- Tabs nav -->
                    <div class="nav flex-column nav-pills nav-pills-custom" id="v-pills-tab" role="tablist"
                        aria-orientation="vertical">
                        {% for user in users %}
                        <a class="nav-link mb-3 p-3 shadow " id="v-pills-{{ user.username }}-tab" data-toggle="pill"
                            href="#{{ user.username }}" role="tab" aria-controls="{{ user.username }}"
                            aria-selected="false">
                            <i class="fa fa-user-circle-o mr-2"></i>
                            <span onclick="createTable({{ user.id }},{{ user.username }})"
                                class="font-weight-bold small text-uppercase">{{ user.username }}</span></a>
                        {% endfor %}
                    </div>
                </div>


                <div class="col-md-9">
                    <!-- Tabs content -->
                    <div class="tab-content" id="v-pills-tabContent">
                        {% for user in users %}
                        <div class="tab-pane fade shadow rounded bg-white p-5" id="{{ user.username }}" role="tabpanel"
                            aria-labelledby="v-pills-{{ user.username }}-tab">
                            <h4 class="font-italic mb-4">{{ user.username }}</h4>

                            <table class="table table-bordered table-dark firstTable">
                                <thead class="firstTh">
                                    <tr>
                                        <!--here goes the rest of the code -->
                                    </tr>
                                </thead>
                                <tbody class="tbodyfirst">

                                </tbody>
                            </table>


                        </div>
                        {% endfor %}
                    </div>
                </div>
            </div>
        </div>
    </section>

</div>

<div class="container">



    <a href="{{ path('manager_binary_prefernces') }}" style="float: right" type="submit" class="btn btn-primary"><svg
            class="bi bi-arrow-right-circle" width="1em" height="1em" viewBox="0 0 16 16" fill="currentColor"
            xmlns="http://www.w3.org/2000/svg">
            <path fill-rule="evenodd" d="M8 15A7 7 0 1 0 8 1a7 7 0 0 0 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z" />
            <path fill-rule="evenodd"
                d="M7.646 11.354a.5.5 0 0 1 0-.708L10.293 8 7.646 5.354a.5.5 0 1 1 .708-.708l3 3a.5.5 0 0 1 0 .708l-3 3a.5.5 0 0 1-.708 0z" />
            <path fill-rule="evenodd" d="M4.5 8a.5.5 0 0 1 .5-.5h5a.5.5 0 0 1 0 1H5a.5.5 0 0 1-.5-.5z" />
        </svg></a>

    <a href="{{ path('generate_experts') }}" style="float: left" type="submit" class="btn btn-danger"><svg
            class="bi bi-arrow-left-circle" width="1em" height="1em" viewBox="0 0 16 16" fill="currentColor"
            xmlns="http://www.w3.org/2000/svg">
            <path fill-rule="evenodd" d="M8 15A7 7 0 1 0 8 1a7 7 0 0 0 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z" />
            <path fill-rule="evenodd"
                d="M8.354 11.354a.5.5 0 0 0 0-.708L5.707 8l2.647-2.646a.5.5 0 1 0-.708-.708l-3 3a.5.5 0 0 0 0 .708l3 3a.5.5 0 0 0 .708 0z" />
            <path fill-rule="evenodd" d="M11.5 8a.5.5 0 0 0-.5-.5H6a.5.5 0 0 0 0 1h5a.5.5 0 0 0 .5-.5z" />
        </svg></a>

</div>

{% endblock %}

{% block javascripts %}
<SCRIPT>
    function createTable(id, name) {
        console.log(name.id);
        $('#clonedTabe').remove();
        $("#" + name.id + " .firstTh tr ").empty();
        $('#' + name.id + ' .tbodyfirst').empty();
        $('#' + name.id + ' .tbodyfirst tr').empty();
        $('#' + name.id + ' .firstTh tr ').append('<th onclick=""scope="col"></th>');

        axios.get('/evaluation/elements/jsongetAllByUser/' + id).then(function (response) {
            var i = 0;
            response.data.forEach(function (element) {
                var text = '<th scope="col">' + element.name + '</th>';
                $('#' + name.id + ' .firstTh tr ').append(text);
            });


            response.data.forEach(function (element) {
                i++;
                console.log(element);
                var texttwo = "<tr class=\"table-active \">\n" +
                    "                <th scope=\"row\">" + element.name + "</th>\n";
                $('#' + name.id + ' .tbodyfirst').append(texttwo);

                var j = 1;
                response.data.forEach(function (element) {
                    if (i == j) {
                        var textthree =
                            "<td style=\"background-color:rgba(179,179,179,0.63) \"> <input type =\"hidden\"value='1'> 1</td>";
                        $('#' + name.id + ' .tbodyfirst tr').last().append(textthree);
                    } else if (i > j) {
                        var textthree = "<td><p id=\"p-" + i + "-" + j +
                            "\"style=\"max-width: 50px;margin-top: 0px;font-size: 15px\"\n" +
                            "></td>";
                        $('#' + name.id + ' .tbodyfirst tr').last().append(textthree);
                        getValues(name, id, i, j, 1);
                    } else if (i < j) {
                        var textthree = "<td><p id=\"p-" + i + "-" + j +
                            "\"style=\"max-width: 50px;margin-top: 0px;font-size: 15px\"\n" +
                            "></td>";
                        $('#' + name.id + ' .tbodyfirst tr').last().append(textthree);
                        getValues(name, id, i, j, 2);
                    }
                    j++;
                });
            });


        }).catch(function (error) {
            console.log(error.message);
        })
    }

    function getValues(name, us, id1, id2, type) {
        axios.get('/getValuesByUser/' + us + '/' + id1 + '/' + id2 + '/' + type).then(function (response) {
            response.data.forEach(function (element) {
                if (element.code !== null) {
                    $("#" + name.id + " #p-" + id1 + "-" + id2).text(element.code);
                } else {
                    $("#" + name.id + " #p-" + id1 + "-" + id2).text('');
                }

            });
        }).catch(function (error) {
            console.log(error.message);
        });
    }
    $('#activated').tooltip('toggle')
</SCRIPT>

{% endblock %}